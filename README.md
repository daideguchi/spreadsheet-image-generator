# スプレッドシート画像生成ツール

OpenAI DALL-E API を使用してスプレッドシートに画像を生成・挿入する Google Apps Script ツールです。

## 🆕 最新更新

### 2025 年 1 月 - Git Auto Push 更新

- Git Auto Push ツールを最新バージョンに更新
- レベル 5、経験値 1200XP 到達
- ゲーム統計機能とバッジシステム追加
- 豊富なコマンドオプションと視覚的機能

## ✨ 最新機能（視覚改善版）

### 🎨 直感的な色分けシステム

- **🟢 緑色・オレンジ色エリア** = ユーザー入力・操作エリア
- **🔘 グレーエリア** = 自動生成・読み取り専用エリア

### 📊 9 列構造化テーブル

- **A 列**：No.（自動連番）
- **B 列**：📝 プロンプト入力（明るい緑色）
- **C 列**：🔗 共通プロンプト選択（オレンジ色）
- **D 列**：📄 結合プロンプト（自動生成・グレー）
- **E 列**：🖼️ 生成画像（自動生成・グレー）
- **F 列**：📐 画像比率（自動計算・グレー）
- **G 列**：⏰ 生成日時（自動記録・グレー）
- **H 列**：✅ ステータス（自動更新・グレー）
- **I 列**：☑️ 選択チェックボックス（薄い青色）

## 🚀 開発者向け - 自動プッシュ機能

### ワンコマンドプッシュ

```bash
# 短縮エイリアス（推奨）
ap

# または
autopush

# カスタムコミットメッセージ付き
ap "新機能を追加"
```

### 機能詳細

- 変更がない場合は自動スキップ
- タイムスタンプ付き自動コミットメッセージ生成
- 全ての変更を自動ステージング・コミット・プッシュ

## 🚀 Google Apps Script での使用方法

### GitHub からの直接取り込み

1. **Google スプレッドシート**を開く
2. **拡張機能** → **Apps Script** でエディタを開く
3. 左側メニューで **「ライブラリ」** の下にある **「リポジトリ」** をクリック
4. **「リポジトリを接続」** をクリック
5. このリポジトリの URL を入力：`https://github.com/daideguchi/spreadsheet-image-generator`
6. **「接続」** をクリック
7. **「プル」** をクリックしてファイルを取り込み

### 手動設定が必要な項目

#### OpenAI API キーについて

**⚠️ 重要：ユーザーが API キーを設定する必要はありません**

このツールは開発者の API キーが事前設定されているため、ユーザーは追加の設定なしですぐに使用できます。

#### 初回実行・権限許可

1. 関数ドロップダウンから **`onOpen`** を選択
2. **「実行」** をクリック
3. 権限確認ダイアログで **「許可」** をクリック
4. スプレッドシートタブに戻り **F5** で再読み込み

### 🔐 権限エラーが発生した場合

**「指定された権限では Ui.showSidebar を呼び出すことができません」** エラーが発生した場合：

1. **メニューから手動実行**：「🎨 画像ツール」→「📱 サイドバーを開く」
2. **権限承認ダイアログ**が表示されたら「承認する」をクリック
3. **Google の権限画面**で以下の権限を許可：
   - ✅ スプレッドシートの表示・編集
   - ✅ サイドバーの表示
   - ✅ 外部サービスへの接続
4. **権限承認完了後**、再度サイドバーを開く
5. **すぐに画像生成開始！**（API キーは事前設定済み）

**💡 Tips：** 初回使用時は自動で歓迎メッセージが表示され、権限承認をガイドします。

## 🎨 使用方法

1. **プロンプト入力**：スプレッドシートのセルに画像生成用プロンプトを入力
2. **範囲選択**：プロンプトを入力したセル範囲を選択
3. **画像生成**：メニュー **「画像ツール」** → **「サイドバーを開く」** → **「画像を生成」**
4. **ダウンロード**：**「画像をダウンロード」** ボタンで ZIP 形式で一括保存

## 📋 含まれるファイル

- **`Code.gs`** - メインスクリプト（自動で Google Apps Script に読み込まれます）
- **`Sidebar.html`** - UI ファイル（自動で Google Apps Script に読み込まれます）
- **`appsscript.json`** - プロジェクト設定（自動で Google Apps Script に読み込まれます）

## 🔍 サポート

詳細なセットアップガイドやトラブルシューティングは `docs/` フォルダ内の各ファイルを参照してください：

- **setup-guide.md** - 詳細セットアップ手順
- **troubleshooting.md** - 問題解決ガイド
- **gas-setup-detailed.md** - 図解付きセットアップ

## ⚡ 注意事項

- OpenAI API の利用には料金が発生します
- DALL-E 3：約 $0.04 per image (1024x1024)
- API 制限にご注意ください

# 🚀 Git Auto Push

**汎用的なワンコマンド Git プッシュツール**

面倒なコミット＆プッシュ作業を一瞬で完了させる、美しいターミナル出力付きの自動化ツールです。

## ✨ 特徴

- 🎨 **美しいカラー出力** - 視覚的に分かりやすいターミナル表示
- ⚡ **超高速** - `ap` だけでコミット＆プッシュが完了
- 🛡️ **安全性** - 変更検出、リモート確認、エラーハンドリング
- 🌍 **汎用的** - あらゆる Git プロジェクトで使用可能
- 📝 **自動メッセージ** - タイムスタンプ付きの自動コミットメッセージ
- 🎯 **カスタマイズ可能** - 独自のコミットメッセージも簡単に指定

## 🚀 ワンコマンド インストール

任意の Git プロジェクトで以下を実行：

```bash
curl -s https://raw.githubusercontent.com/daideguchi/git-autopush/main/install.sh | bash
```

## 📖 使用方法

### 基本的な使用方法

```bash
# 自動メッセージでプッシュ
ap

# カスタムメッセージでプッシュ
ap "新機能を追加"
ap "バグ修正"
ap "🎉 リリース準備完了"
```

### 使用例

```bash
# 作業完了後、一瞬でプッシュ
$ ap "✨ 新機能実装完了"

🚀 Git Auto Push Tool
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
ℹ️ 変更されたファイル:
  M  src/main.js
  A  src/utils.js
  M  README.md

📦 コミットメッセージ: ✨ 新機能実装完了
ℹ️ 変更をステージング中...
ℹ️ コミット中...
✅ コミット完了
ℹ️ リモートリポジトリにプッシュ中...

✅✅✅ 自動プッシュ完了！✅✅✅
Repository: https://github.com/user/project.git
Branch: main
Commit: a1b2c3d
```

## 🛠️ 手動インストール

```bash
# autopush.sh をダウンロード
curl -O https://raw.githubusercontent.com/daideguchi/git-autopush/main/autopush.sh

# 実行権限を付与
chmod +x autopush.sh

# エイリアスを設定（zsh の場合）
echo "alias ap='./autopush.sh'" >> ~/.zshrc
echo "alias autopush='./autopush.sh'" >> ~/.zshrc
source ~/.zshrc
```

## 🔧 エイリアス

インストール後、以下のエイリアスが使用可能：

- `ap` - 短縮版（推奨）
- `autopush` - フルネーム版

## 📝 機能詳細

### 自動チェック機能

- ✅ Git リポジトリの確認
- ✅ 変更の有無をチェック
- ✅ リモートリポジトリの設定確認
- ✅ 変更されたファイルの表示

### エラーハンドリング

- 🛡️ Git リポジトリでない場合の警告
- 🛡️ 変更がない場合の自動スキップ
- 🛡️ リモートが未設定の場合の案内
- 🛡️ コミット・プッシュ失敗時のエラー表示

### 自動メッセージ生成

カスタムメッセージが指定されない場合、以下の形式で自動生成：

```
🔄 自動更新 - 2025-01-20 14:30
```

## 🌟 適用プロジェクト例

- **Web 開発** - React、Vue、Angular プロジェクト
- **モバイル開発** - Flutter、React Native
- **バックエンド** - Node.js、Python、Go
- **ドキュメント** - Markdown、技術文書
- **設定ファイル** - dotfiles、設定管理
- **その他** - あらゆる Git プロジェクト

## 💡 開発者向け情報

### カスタマイズ

`autopush.sh` を直接編集することで、以下をカスタマイズ可能：

- コミットメッセージの形式
- カラーテーマ
- 出力メッセージ
- チェック機能の追加

### 貢献

プルリクエストやイシューはいつでも歓迎です！

## 📄 ライセンス

MIT License

---

**🎯 あらゆるプロジェクトで `ap` するだけ。シンプルで強力な Git 自動化ツール。**

# テストコメント
