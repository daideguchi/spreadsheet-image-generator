# スプレッドシート画像生成ツール

Google スプレッドシートと DALL-E API を連携した画像生成・ダウンロードツールです。

## 🚀 Google Apps Script での使用方法

### GitHub からの直接取り込み

1. **Google スプレッドシート**を開く
2. **拡張機能** → **Apps Script** でエディタを開く
3. 左側メニューで **「ライブラリ」** の下にある **「リポジトリ」** をクリック
4. **「リポジトリを接続」** をクリック
5. このリポジトリの URL を入力：`https://github.com/daideguchi/spreadsheet-image-generator`
6. **「接続」** をクリック
7. **「プル」** をクリックしてファイルを取り込み

### 手動設定が必要な項目

#### OpenAI API キーについて

**⚠️ 重要：ユーザーが API キーを設定する必要はありません**

このツールは開発者の API キーが事前設定されているため、ユーザーは追加の設定なしですぐに使用できます。

#### 初回実行・権限許可

1. 関数ドロップダウンから **`onOpen`** を選択
2. **「実行」** をクリック
3. 権限確認ダイアログで **「許可」** をクリック
4. スプレッドシートタブに戻り **F5** で再読み込み

### 🔐 権限エラーが発生した場合

**「指定された権限では Ui.showSidebar を呼び出すことができません」** エラーが発生した場合：

1. **メニューから手動実行**：「🎨 画像ツール」→「📱 サイドバーを開く」
2. **権限承認ダイアログ**が表示されたら「承認する」をクリック
3. **Google の権限画面**で以下の権限を許可：
   - ✅ スプレッドシートの表示・編集
   - ✅ サイドバーの表示
   - ✅ 外部サービスへの接続
4. **権限承認完了後**、再度サイドバーを開く
5. **すぐに画像生成開始！**（API キーは事前設定済み）

**💡 Tips：** 初回使用時は自動で歓迎メッセージが表示され、権限承認をガイドします。

## 🎨 使用方法

1. **プロンプト入力**：スプレッドシートのセルに画像生成用プロンプトを入力
2. **範囲選択**：プロンプトを入力したセル範囲を選択
3. **画像生成**：メニュー **「画像ツール」** → **「サイドバーを開く」** → **「画像を生成」**
4. **ダウンロード**：**「画像をダウンロード」** ボタンで ZIP 形式で一括保存

## 📋 含まれるファイル

- **`Code.gs`** - メインスクリプト（自動で Google Apps Script に読み込まれます）
- **`Sidebar.html`** - UI ファイル（自動で Google Apps Script に読み込まれます）
- **`appsscript.json`** - プロジェクト設定（自動で Google Apps Script に読み込まれます）

## 🔍 サポート

詳細なセットアップガイドやトラブルシューティングは `docs/` フォルダ内の各ファイルを参照してください：

- **setup-guide.md** - 詳細セットアップ手順
- **troubleshooting.md** - 問題解決ガイド
- **gas-setup-detailed.md** - 図解付きセットアップ

## ⚡ 注意事項

- OpenAI API の利用には料金が発生します
- DALL-E 3：約 $0.04 per image (1024x1024)
- API 制限にご注意ください
